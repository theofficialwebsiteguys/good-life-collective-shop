<div class="shop-container">
    <!-- Sidebar Toggle Button (Visible on Mobile) -->
    <button class="sidebar-toggle" (click)="toggleSidebar()">☰ Filters</button>
  
    <div class="sidebar" [class.open]="isSidebarOpen">
      <button class="close-btn" (click)="clearFilters()">Clear Filters</button>
  
      <!-- Strains -->
      <div class="filter-section">
        <h3 (click)="toggleSection('types')">
          Strains <span [class.expanded]="isExpanded['types']">−</span>
        </h3>
        <div *ngIf="isExpanded['types']" class="filter-options">
          <label *ngFor="let type of types">
            <input type="checkbox" (change)="toggleTypeFilter(type.name)" [checked]="selectedTypes.includes(type.name)"/>
            {{ type.name }}
          </label>
        </div>
      </div>
  
      <!-- Brands -->
      <div class="filter-section">
        <h3 (click)="toggleSection('brands')">
          Brands <span [class.expanded]="isExpanded['brands']">−</span>
        </h3>
        <div *ngIf="isExpanded['brands']" class="filter-options">
          <ng-container *ngIf="dynamicFilterOptions$ | async as dynamicFilterOptions">
            <label *ngFor="let brand of dynamicFilterOptions.brands">
              <input 
                type="checkbox" 
                (change)="toggleBrandFilter(brand.value)" 
                [checked]="selectedBrands.includes(brand.value)"
              />
              {{ brand.label }}
            </label>
          </ng-container>
        </div>
      </div>
  
      <!-- Weights -->
      <div class="filter-section">
        <h3 (click)="toggleSection('weights')">
          Weights <span [class.expanded]="isExpanded['weights']">−</span>
        </h3>
        <div *ngIf="isExpanded['weights']" class="filter-options">
          <ng-container *ngIf="dynamicFilterOptions$ | async as dynamicFilterOptions">
            <label *ngFor="let weight of dynamicFilterOptions.weights">
              <input 
                type="checkbox" 
                (change)="toggleWeightsFilter(weight.value)" 
                [checked]="selectedWeights.includes(weight.value)"
              />
              {{ weight.label }}
            </label>
          </ng-container>
        </div>
      </div>
    </div>
  
    <div class="main-content">
              <!-- Sort Section -->
              <div class="sort-search-container">
                <!-- Search Bar -->
                <input 
                  type="text" 
                  [(ngModel)]="searchQuery"
                  placeholder="Search products..."
                  class="search-input"
                  aria-label="Search products"
                />
              
                <!-- Sort Dropdown -->
                <label>Sort by:</label>
                <select [(ngModel)]="sortOption"  class="sort-dropdown">
                  <option value="RECENT">Newest</option>
                  <option value="PRICE_ASC">Price: Low to High</option>
                  <option value="PRICE_DESC">Price: High to Low</option>
                  <option value="THC_ASC">THC: Low to High</option>
                  <option value="THC_DESC">THC: High to Low</option>
                  <option value="NAME">Alphabetical</option>
                </select>

                <lib-cart-icon></lib-cart-icon>

                <lib-auth-nav></lib-auth-nav>

              </div>

      <lib-product-list 
        [category]="category"
        [selectedBrands]="selectedBrands"
        [selectedWeights]="selectedWeights"
        [selectedTypes]="selectedTypes"
        [searchQuery]="searchQuery"
        [sortOption]="sortOption"
      ></lib-product-list>
    </div>
  </div>
  